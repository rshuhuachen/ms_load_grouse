#phenotypes
load("data/phenotypes/phenotypes_long_formodels_withsurv.RData")
#phenotypes
load("data/phenotypes/phenotypes_wide_extra.RData")
## add core
pheno_long_models_ly <- pheno_long_models_ly %>% mutate(core = as.factor(case_when(
!is.na(LMS) ~ "core",
is.na(LMS) ~ "no core"
)))
pacman::p_load(tidyverse)
#phenotypes
load("data/phenotypes/phenotypes_wide_extra.RData")
load("data/phenotypes/phenotypes_long_formodels_withsurv.RData") #from genetic_load_ltet
## add core
pheno_long_models_ly <- pheno_long_models_ly %>% mutate(core = as.factor(case_when(
!is.na(LMS) ~ "core",
is.na(LMS) ~ "no core"
)))
View(pheno_long_models_ly)
wide <- read.csv("data/phenotypes/phenotypes_wide.csv")
View(wide)
## add core
wide <- wide %>% mutate(core = as.factor(case_when(
!is.na(LMS) ~ "core",
is.na(LMS) ~ "no core"
)))
wide$born <- wide$year - wide$age
#phenotypes
load("data/phenotypes/phenotypes_wide_extra.RData")
pheno_long_models_ly$born <- pheno_long_models_ly$year - pheno_long_models_ly$age
View(pheno_long_models_ly)
#phenotypes
load("data/phenotypes/phenotypes_wide_extra.RData")
load("data/phenotypes/phenotypes_long_formodels_withsurv.RData") #from genetic_load_ltet
## add core
pheno <- pheno %>% mutate(core = as.factor(case_when(
!is.na(LMS) ~ "core",
is.na(LMS) ~ "no core"
)))
View(pheno)
source('/vol/cluster-data/rchen/git/ms_load_inbreeding_grouse/script_arrange_repo.R')
pheno_select <- pheno %>% select(c(id:died, sitename:succ.years, leks, LMS))
pheno_select <- pheno %>% select(c(id:died, sitename:succ.years, leks, LMS, LMS_min, core))
#phenotypes
load("../genetic_load_ltet/data/phenotypes/phenotypes_wide_extra.RData")
load("../genetic_load_ltet/data/phenotypes/phenotypes_long_formodels_withsurv.RData") #from genetic_load_ltet
#phenotypes
load("../genetic_load_ltet/data/phenotypes/phenotypes_wide_extra.RData")
load("../genetic_load_ltet/data/phenotypes/phenotypes_long_formodels_withsurv.RData") #from genetic_load_ltet
## add core
pheno <- pheno %>% mutate(core = as.factor(case_when(
!is.na(LMS) ~ "core",
is.na(LMS) ~ "no core"
)))
pheno_select <- pheno %>% select(c(id:died, sitename:succ.years, leks, LMS, LMS_min, core))
View(pheno_select)
write.csv(pheno_select, file = "data/phenotypes/phenotypes_lifetime.csv", quote=F, row.names = F)
save(pheno_select, file = "data/phenotypes/phenotypes_lifetime.RData")
core <- subst(pheno_select, core == "core")
core <- subset(pheno_select, core == "core")
#long
pheno_long_models_ly$born <- pheno_long_models_ly$year - pheno_long_models_ly$age
rm(core)
pheno_long_models_ly <- left_join(pheno_long_models_ly, pheno[,c("id", "core")], by = "id")
View(pheno_long_models_ly)
names(pheno_long_models_ly)
pheno_wide <- pheno %>% select(c(id:died, sitename:succ.years, leks, LMS, LMS_min, core))
write.csv(pheno_wide, file = "data/phenotypes/phenotypes_lifetime.csv", quote=F, row.names = F)
save(pheno_wide, file = "data/phenotypes/phenotypes_lifetime.RData")
load("../genetic_load_ltet/data/phenotypes/phenotypes_long_formodels_withsurv.RData") #from genetic_load_ltet
#long
pheno_long_models_ly$born <- pheno_long_models_ly$year - pheno_long_models_ly$age
pheno_long_models_ly <- left_join(pheno_long_models_ly, pheno[,c("id", "core")], by = "id")
names(pheno_long_models_ly)
pheno_long <- pheno_long_models_ly %>% select(c(id:MS, core, born))
View(pheno_long)
pheno_long <- pheno_long_models_ly %>% select(c(id:age, lyre:MS, core, born))
names(pheno_long)
pheno_long <- pheno_long_models_ly %>% select(c(id, year, born, age, core, site, lifespan,lyre:MS))
write.csv(pheno_long, file = "data/phenotypes/phenotypes_annual.csv", quote=F, row.names = F)
save(pheno_long, file = "data/phenotypes/phenotypes_annual.RData")
